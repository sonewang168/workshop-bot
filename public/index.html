<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¬›å¸«å·¥ä½œåŠè‡ªå‹•åŒ–ç®¡ç†ç³»çµ±</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--bg:#0a0a0f;--bg2:#12121a;--bg3:#1a1a24;--card:#16161f;--border:#2a2a3a;--text:#f0f0f5;--text2:#8888a0;--text3:#5a5a70;--accent:#6366f1;--success:#10b981;--warning:#f59e0b;--danger:#ef4444;--grad:linear-gradient(135deg,#6366f1 0%,#a855f7 100%)}
        body{font-family:'Noto Sans TC',sans-serif;background:var(--bg);color:var(--text);min-height:100vh}
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
        @keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}
        @keyframes spin{to{transform:rotate(360deg)}}
        .fade{animation:fadeIn .4s ease-out}
        .container{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;position:relative}
        .container::before{content:'';position:absolute;inset:0;background:radial-gradient(circle at 20% 80%,rgba(99,102,241,.15) 0%,transparent 50%),radial-gradient(circle at 80% 20%,rgba(168,85,247,.1) 0%,transparent 50%)}
        .box{background:var(--card);border:1px solid var(--border);border-radius:24px;padding:48px;width:100%;max-width:520px;position:relative;z-index:1;box-shadow:0 25px 50px -12px rgba(0,0,0,.5)}
        .logo{text-align:center;margin-bottom:32px}
        .logo-icon{width:72px;height:72px;background:var(--grad);border-radius:18px;display:flex;align-items:center;justify-content:center;margin:0 auto 16px;font-size:32px}
        .logo h1{font-size:24px;margin-bottom:8px}
        .logo p{color:var(--text2);font-size:14px}
        .info-card{background:var(--bg3);border-radius:16px;padding:20px;margin-bottom:24px}
        .info-item{display:flex;align-items:center;gap:12px;padding:8px 0;font-size:14px;color:var(--text2)}
        .form-group{margin-bottom:20px}
        .form-label{display:block;font-size:13px;font-weight:500;color:var(--text2);margin-bottom:8px}
        .form-input{width:100%;padding:14px 16px;background:var(--bg2);border:1px solid var(--border);border-radius:12px;color:var(--text);font-size:15px;font-family:inherit;transition:.2s}
        .form-input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(99,102,241,.3)}
        .form-input::placeholder{color:var(--text3)}
        .form-textarea{min-height:120px;resize:vertical}
        .form-select{appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%238888a0'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;background-size:20px;padding-right:40px}
        .form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
        .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:14px 24px;border-radius:12px;font-size:15px;font-weight:500;font-family:inherit;cursor:pointer;transition:.2s;border:none}
        .btn-primary{background:var(--grad);color:#fff}
        .btn-primary:hover{transform:translateY(-2px);box-shadow:0 10px 20px -5px rgba(99,102,241,.3)}
        .btn-primary:disabled{opacity:.6;cursor:not-allowed;transform:none}
        .btn-secondary{background:var(--bg3);color:var(--text);border:1px solid var(--border)}
        .btn-secondary:hover{background:var(--border)}
        .btn-ghost{background:transparent;color:var(--text2);padding:8px 16px}
        .btn-ghost:hover{color:var(--text);background:var(--bg3)}
        .btn-icon{width:40px;height:40px;padding:0;border-radius:10px}
        .btn-ai{background:linear-gradient(135deg,#6366f1 0%,#a855f7 50%,#6366f1 100%);background-size:200% 100%;animation:shimmer 2s linear infinite;color:#fff}
        .btn-full{width:100%}
        .layout{display:flex;min-height:100vh}
        .sidebar{width:280px;background:var(--bg2);border-right:1px solid var(--border);display:flex;flex-direction:column;position:fixed;height:100vh;z-index:100}
        .sidebar-header{padding:24px;border-bottom:1px solid var(--border)}
        .sidebar-logo{display:flex;align-items:center;gap:12px}
        .sidebar-logo-icon{width:40px;height:40px;background:var(--grad);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px}
        .sidebar-logo-text{font-size:16px;font-weight:700}
        .sidebar-nav{flex:1;padding:16px 12px;overflow-y:auto}
        .nav-section{margin-bottom:24px}
        .nav-section-title{font-size:11px;font-weight:600;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;padding:0 12px;margin-bottom:8px}
        .nav-item{display:flex;align-items:center;gap:12px;padding:12px 16px;border-radius:10px;color:var(--text2);cursor:pointer;transition:.2s;margin-bottom:4px}
        .nav-item:hover{background:var(--bg3);color:var(--text)}
        .nav-item.active{background:var(--accent);color:#fff}
        .nav-item-icon{width:20px;text-align:center;font-size:16px}
        .nav-item-text{font-size:14px;font-weight:500}
        .sidebar-footer{padding:16px;border-top:1px solid var(--border)}
        .user-card{display:flex;align-items:center;gap:12px;padding:12px;background:var(--bg3);border-radius:12px}
        .user-avatar{width:40px;height:40px;background:linear-gradient(135deg,#3b82f6 0%,#06b6d4 100%);border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:14px}
        .user-info{flex:1;min-width:0}
        .user-name{font-size:14px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .user-email{font-size:12px;color:var(--text3);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .main{flex:1;margin-left:280px;min-height:100vh}
        .main-header{background:var(--bg2);border-bottom:1px solid var(--border);padding:20px 32px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:50}
        .main-title{font-size:20px;font-weight:700}
        .main-subtitle{font-size:13px;color:var(--text2);margin-top:4px}
        .main-body{padding:32px}
        .stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:32px}
        .stat-card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:24px;transition:.3s}
        .stat-card:hover{transform:translateY(-4px);box-shadow:0 12px 24px -8px rgba(0,0,0,.3)}
        .stat-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
        .stat-icon{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px}
        .stat-icon.purple{background:rgba(99,102,241,.15)}
        .stat-icon.green{background:rgba(16,185,129,.15)}
        .stat-icon.blue{background:rgba(59,130,246,.15)}
        .stat-icon.orange{background:rgba(245,158,11,.15)}
        .stat-trend{font-size:12px;font-weight:500;padding:4px 8px;border-radius:6px;background:rgba(16,185,129,.15);color:var(--success)}
        .stat-value{font-size:32px;font-weight:700;margin-bottom:4px}
        .stat-label{font-size:14px;color:var(--text2)}
        .card{background:var(--card);border:1px solid var(--border);border-radius:16px;overflow:hidden}
        .card-header{padding:20px 24px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
        .card-title{font-size:16px;font-weight:600}
        .card-body{padding:24px}
        .events-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:20px}
        .event-card{background:var(--card);border:1px solid var(--border);border-radius:16px;overflow:hidden;transition:.3s}
        .event-card:hover{transform:translateY(-4px);box-shadow:0 12px 24px -8px rgba(0,0,0,.3);border-color:var(--accent)}
        .event-banner{height:120px;background:var(--grad);position:relative;display:flex;align-items:center;justify-content:center;font-size:48px}
        .event-status{position:absolute;top:12px;right:12px;padding:6px 12px;border-radius:8px;font-size:12px;font-weight:600}
        .event-status.active{background:var(--success);color:#fff}
        .event-status.draft{background:var(--text3);color:#fff}
        .event-status.ended{background:var(--danger);color:#fff}
        .event-content{padding:20px}
        .event-title{font-size:16px;font-weight:600;margin-bottom:8px}
        .event-meta{display:flex;flex-wrap:wrap;gap:12px;font-size:13px;color:var(--text2);margin-bottom:16px}
        .event-meta-item{display:flex;align-items:center;gap:6px}
        .event-stats{display:flex;gap:20px;padding-top:16px;border-top:1px solid var(--border)}
        .event-stat{text-align:center}
        .event-stat-value{font-size:20px;font-weight:700;color:var(--accent)}
        .event-stat-label{font-size:12px;color:var(--text3)}
        .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.7);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:200;padding:20px}
        .modal{background:var(--card);border:1px solid var(--border);border-radius:20px;width:100%;max-width:600px;max-height:90vh;overflow:hidden;display:flex;flex-direction:column;animation:fadeIn .3s ease-out}
        .modal-header{padding:24px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
        .modal-title{font-size:18px;font-weight:600}
        .modal-close{width:36px;height:36px;border-radius:10px;background:var(--bg3);border:none;color:var(--text2);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px;transition:.2s}
        .modal-close:hover{background:var(--border);color:var(--text)}
        .modal-body{padding:24px;overflow-y:auto;flex:1}
        .modal-footer{padding:20px 24px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:12px}
        .table{width:100%;border-collapse:collapse}
        .table th,.table td{padding:14px 16px;text-align:left;border-bottom:1px solid var(--border)}
        .table th{font-size:12px;font-weight:600;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;background:var(--bg3)}
        .table td{font-size:14px}
        .table tr:hover td{background:var(--bg3)}
        .badge{display:inline-flex;align-items:center;padding:4px 10px;border-radius:6px;font-size:12px;font-weight:500}
        .badge-success{background:rgba(16,185,129,.15);color:var(--success)}
        .badge-warning{background:rgba(245,158,11,.15);color:var(--warning)}
        .badge-info{background:rgba(59,130,246,.15);color:#3b82f6}
        .empty{text-align:center;padding:60px 20px}
        .empty-icon{font-size:64px;margin-bottom:20px;opacity:.5}
        .empty-title{font-size:18px;font-weight:600;margin-bottom:8px}
        .empty-text{font-size:14px;color:var(--text2);margin-bottom:24px}
        .toast-container{position:fixed;bottom:24px;right:24px;z-index:300;display:flex;flex-direction:column;gap:12px}
        .toast{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px 20px;display:flex;align-items:center;gap:12px;box-shadow:0 10px 30px rgba(0,0,0,.3);animation:fadeIn .3s ease-out;min-width:300px}
        .toast-icon{font-size:20px}
        .toast-success .toast-icon{color:var(--success)}
        .toast-error .toast-icon{color:var(--danger)}
        .toast-warning .toast-icon{color:var(--warning)}
        .toast-message{flex:1;font-size:14px}
        .panel{background:var(--bg3);border:1px solid var(--border);border-radius:16px;padding:24px;margin-bottom:24px}
        .panel-title{font-size:16px;font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:10px}
        .output{background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:20px;min-height:200px;white-space:pre-wrap;font-family:monospace;font-size:13px;line-height:1.6;position:relative}
        .copy-btn{position:absolute;top:12px;right:12px}
        .cert-preview{background:#fff;border-radius:12px;padding:20px}
        .cert{background:linear-gradient(135deg,#fefce8 0%,#fef3c7 100%);border:12px double #b45309;border-radius:8px;padding:50px;text-align:center;max-width:700px;margin:0 auto}
        .cert-header{font-size:14px;color:#92400e;letter-spacing:6px;margin-bottom:16px;font-weight:500}
        .cert-title{font-size:42px;font-weight:900;color:#78350f;margin-bottom:30px;font-family:serif}
        .cert-name{font-size:32px;font-weight:700;color:#b45309;margin-bottom:20px;border-bottom:3px solid #b45309;display:inline-block;padding:0 40px 10px}
        .cert-body{font-size:18px;color:#44403c;margin-bottom:40px;line-height:1.8}
        .cert-footer{display:flex;justify-content:space-around;margin-top:50px;padding-top:30px;border-top:1px solid #d6d3d1}
        .cert-sig{text-align:center}
        .cert-sig-line{width:180px;border-bottom:2px solid #78350f;margin-bottom:10px}
        .cert-sig-label{font-size:12px;color:#78350f;font-weight:500}
        .checkbox-wrapper{display:flex;align-items:center;gap:10px;cursor:pointer}
        .checkbox{width:20px;height:20px;border:2px solid var(--border);border-radius:6px;display:flex;align-items:center;justify-content:center;transition:.2s}
        .checkbox.checked{background:var(--accent);border-color:var(--accent)}
        .loading{width:40px;height:40px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin .8s linear infinite}
        .loading-overlay{position:fixed;inset:0;background:rgba(10,10,15,.9);display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;z-index:400}
        .success-icon{width:80px;height:80px;background:rgba(16,185,129,.15);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:40px;margin:0 auto 24px}
        @media(max-width:1200px){.stats-grid{grid-template-columns:repeat(2,1fr)}}
        @media(max-width:768px){.sidebar{display:none}.main{margin-left:0}.stats-grid{grid-template-columns:1fr}.form-row{grid-template-columns:1fr}}
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const{useState,useEffect,useCallback}=React;
        const demoEvents=[{id:'1',title:'AI ç¹ªåœ–å…¥é–€å·¥ä½œåŠ',description:'å­¸ç¿’ä½¿ç”¨ Stable Diffusion å’Œ ComfyUI é€²è¡Œ AI ç¹ªåœ–',date:'2026-01-15',time:'14:00',endTime:'17:00',location:'ç·šä¸Š Google Meet',maxParticipants:30,status:'active',registrations:24,notifications:2,certificates:0,instructorName:'ç‹è€å¸«'},{id:'2',title:'Vibe Coding å¯¦æˆ°ç‡Ÿ',description:'ç”¨è‡ªç„¶èªè¨€æè¿°éœ€æ±‚ï¼Œè®“ AI å¹«ä½ å¯«ç¨‹å¼',date:'2026-01-22',time:'09:00',endTime:'12:00',location:'å°åŒ—å¸‚ä¿¡ç¾©å€æŸæœƒè­°å®¤',maxParticipants:20,status:'draft',registrations:0,notifications:0,certificates:0,instructorName:'ç‹è€å¸«'},{id:'3',title:'ChatGPT æ•™å­¸æ‡‰ç”¨å·¥ä½œåŠ',description:'å°‡ç”Ÿæˆå¼ AI èå…¥æ•™å­¸ç¾å ´çš„å¯¦å‹™æŠ€å·§',date:'2025-12-20',time:'13:30',endTime:'16:30',location:'ç·šä¸Š Zoom',maxParticipants:50,status:'ended',registrations:48,notifications:5,certificates:45,instructorName:'ç‹è€å¸«'}];
        const demoRegs=[{id:'1',eventId:'1',name:'ç‹å°æ˜',email:'xiaoming@example.com',phone:'0912345678',createdAt:'2026-01-02',status:'confirmed'},{id:'2',eventId:'1',name:'æå°è¯',email:'xiaohua@example.com',phone:'0923456789',createdAt:'2026-01-02',status:'confirmed'},{id:'3',eventId:'1',name:'å¼µå¤§åŒ',email:'datong@example.com',phone:'0934567890',createdAt:'2026-01-03',status:'pending'},{id:'4',eventId:'3',name:'é™³ç¾éº—',email:'meili@example.com',phone:'0945678901',createdAt:'2025-12-15',status:'confirmed'},{id:'5',eventId:'3',name:'æ—å¿—æ˜',email:'zhiming@example.com',phone:'0956789012',createdAt:'2025-12-16',status:'confirmed'}];
        const I={dashboard:'ğŸ“Š',events:'ğŸ“…',registrations:'ğŸ“‹',poster:'ğŸ¨',notification:'ğŸ“¨',certificate:'ğŸ†',settings:'âš™ï¸',logout:'ğŸšª',add:'â•',edit:'âœï¸',delete:'ğŸ—‘ï¸',copy:'ğŸ“„',download:'ğŸ“¥',send:'ğŸ“¤',check:'âœ“',close:'âœ•',calendar:'ğŸ“†',location:'ğŸ“',people:'ğŸ‘¥',email:'âœ‰ï¸',ai:'ğŸ¤–',magic:'âœ¨',loading:'â³',success:'âœ…',error:'âŒ',warning:'âš ï¸',info:'â„¹ï¸',link:'ğŸ”—',line:'ğŸ’¬',clock:'ğŸ•'};
        
        const ToastCtx=React.createContext();
        function ToastProvider({children}){const[toasts,setToasts]=useState([]);const addToast=useCallback((msg,type='success')=>{const id=Date.now();setToasts(p=>[...p,{id,msg,type}]);setTimeout(()=>setToasts(p=>p.filter(t=>t.id!==id)),3000)},[]);return(<ToastCtx.Provider value={{addToast}}>{children}<div className="toast-container">{toasts.map(t=>(<div key={t.id} className={`toast toast-${t.type}`}><span className="toast-icon">{t.type==='success'?I.success:t.type==='error'?I.error:I.warning}</span><span className="toast-message">{t.msg}</span></div>))}</div></ToastCtx.Provider>)}
        function useToast(){return React.useContext(ToastCtx)}
        
        async function callGemini(key,prompt){const r=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${key}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({contents:[{parts:[{text:prompt}]}],generationConfig:{temperature:0.8,maxOutputTokens:1024}})});if(!r.ok)throw new Error('Gemini API å¤±æ•—');const d=await r.json();return d.candidates[0].content.parts[0].text}
        
        function PublicForm({eventId,events,onReg}){const[form,setForm]=useState({name:'',email:'',phone:'',org:''});const[done,setDone]=useState(false);const[loading,setLoading]=useState(false);const ev=events.find(e=>e.id===eventId);if(!ev)return(<div className="container"><div className="box fade"><div className="logo"><div className="logo-icon">âŒ</div><h1>æ‰¾ä¸åˆ°æ´»å‹•</h1></div></div></div>);if(ev.status!=='active')return(<div className="container"><div className="box fade"><div className="logo"><div className="logo-icon">â°</div><h1>{ev.title}</h1><p>{ev.status==='draft'?'å°šæœªé–‹æ”¾å ±å':'å ±åå·²æˆªæ­¢'}</p></div></div></div>);const submit=async e=>{e.preventDefault();setLoading(true);await new Promise(r=>setTimeout(r,1000));onReg({...form,eventId:ev.id,createdAt:new Date().toISOString().split('T')[0],status:'pending'});setLoading(false);setDone(true)};if(done)return(<div className="container"><div className="box fade"><div className="success-icon">âœ…</div><h1 style={{textAlign:'center',marginBottom:'16px'}}>å ±åæˆåŠŸï¼</h1><p style={{textAlign:'center',color:'var(--text2)',marginBottom:'24px'}}>æ„Ÿè¬æ‚¨å ±åã€Œ{ev.title}ã€</p><div className="info-card"><div className="info-item"><span>{I.calendar}</span><span>æ—¥æœŸï¼š<strong>{ev.date}</strong></span></div><div className="info-item"><span>{I.clock}</span><span>æ™‚é–“ï¼š<strong>{ev.time} - {ev.endTime}</strong></span></div><div className="info-item"><span>{I.location}</span><span>åœ°é»ï¼š<strong>{ev.location}</strong></span></div></div></div></div>);return(<div className="container"><div className="box fade"><div className="logo"><div className="logo-icon">ğŸ“</div><h1>{ev.title}</h1><p>ç·šä¸Šå ±åè¡¨</p></div><div className="info-card"><div className="info-item"><span>{I.calendar}</span><span>{ev.date} {ev.time}</span></div><div className="info-item"><span>{I.location}</span><span>{ev.location}</span></div><div className="info-item"><span>{I.people}</span><span>å‰©é¤˜åé¡ï¼š{ev.maxParticipants-ev.registrations}</span></div></div><form onSubmit={submit}><div className="form-group"><label className="form-label">å§“å *</label><input type="text" className="form-input" value={form.name} onChange={e=>setForm({...form,name:e.target.value})} required/></div><div className="form-group"><label className="form-label">Email *</label><input type="email" className="form-input" value={form.email} onChange={e=>setForm({...form,email:e.target.value})} required/></div><div className="form-group"><label className="form-label">æ‰‹æ©Ÿ *</label><input type="tel" className="form-input" value={form.phone} onChange={e=>setForm({...form,phone:e.target.value})} required/></div><div className="form-group"><label className="form-label">æœå‹™å–®ä½</label><input type="text" className="form-input" value={form.org} onChange={e=>setForm({...form,org:e.target.value})}/></div><button type="submit" className="btn btn-primary btn-full" disabled={loading}>{loading?I.loading+' é€å‡ºä¸­...':I.send+' é€å‡ºå ±å'}</button></form></div></div>)}
        
        function LoginPage({onLogin}){const[isReg,setIsReg]=useState(false);const[email,setEmail]=useState('');const[pw,setPw]=useState('');const[name,setName]=useState('');const submit=e=>{e.preventDefault();onLogin({email:email||'demo@example.com',name:name||'ç¤ºç¯„è¬›å¸«',uid:'demo'})};return(<div className="container"><div className="box fade"><div className="logo"><div className="logo-icon">ğŸ“</div><h1>è¬›å¸«å·¥ä½œåŠç®¡ç†ç³»çµ±</h1><p>è‡ªå‹•åŒ–æ‚¨çš„å·¥ä½œåŠæµç¨‹</p><p style={{color:'var(--warning)',marginTop:'8px',fontSize:'12px'}}>âš ï¸ å±•ç¤ºæ¨¡å¼</p></div><form onSubmit={submit}>{isReg&&<div className="form-group"><label className="form-label">è¬›å¸«å§“å</label><input type="text" className="form-input" placeholder="æ‚¨çš„å§“å" value={name} onChange={e=>setName(e.target.value)}/></div>}<div className="form-group"><label className="form-label">é›»å­éƒµä»¶</label><input type="email" className="form-input" placeholder="your@email.com" value={email} onChange={e=>setEmail(e.target.value)}/></div><div className="form-group"><label className="form-label">å¯†ç¢¼</label><input type="password" className="form-input" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" value={pw} onChange={e=>setPw(e.target.value)}/></div><button type="submit" className="btn btn-primary btn-full">{isReg?'è¨»å†Šå¸³è™Ÿ':'ç™»å…¥ç³»çµ±'}</button></form><div style={{textAlign:'center',marginTop:'24px',color:'var(--text2)',fontSize:'14px'}}>{isReg?'å·²æœ‰å¸³è™Ÿï¼Ÿ':'æ²’æœ‰å¸³è™Ÿï¼Ÿ'}<button onClick={()=>setIsReg(!isReg)} style={{background:'none',border:'none',color:'var(--accent)',fontFamily:'inherit',cursor:'pointer',fontWeight:'500'}}>{isReg?'ç«‹å³ç™»å…¥':'å…è²»è¨»å†Š'}</button></div><div style={{marginTop:'20px'}}><button className="btn btn-secondary btn-full" onClick={()=>onLogin({email:'demo@example.com',name:'ç¤ºç¯„è¬›å¸«',uid:'demo'})}>{I.magic} å¿«é€Ÿé«”é©—</button></div></div></div>)}
        
        function Sidebar({user,page,setPage,onLogout}){const nav=[{id:'dashboard',icon:I.dashboard,label:'ç¸½è¦½å„€è¡¨æ¿'},{id:'events',icon:I.events,label:'æ´»å‹•ç®¡ç†'},{id:'registrations',icon:I.registrations,label:'å ±åç®¡ç†'},{id:'poster',icon:I.poster,label:'AI æ–‡å®£ç”¢ç”Ÿå™¨'},{id:'notification',icon:I.notification,label:'é€šçŸ¥ä¸­å¿ƒ'},{id:'certificate',icon:I.certificate,label:'è­‰æ›¸ç”¢ç”Ÿå™¨'}];return(<aside className="sidebar"><div className="sidebar-header"><div className="sidebar-logo"><div className="sidebar-logo-icon">ğŸ“</div><span className="sidebar-logo-text">å·¥ä½œåŠç®¡ç†</span></div></div><nav className="sidebar-nav"><div className="nav-section"><div className="nav-section-title">ä¸»é¸å–®</div>{nav.map(n=>(<div key={n.id} className={`nav-item ${page===n.id?'active':''}`} onClick={()=>setPage(n.id)}><span className="nav-item-icon">{n.icon}</span><span className="nav-item-text">{n.label}</span></div>))}</div><div className="nav-section"><div className="nav-section-title">ç³»çµ±</div><div className={`nav-item ${page==='settings'?'active':''}`} onClick={()=>setPage('settings')}><span className="nav-item-icon">{I.settings}</span><span className="nav-item-text">ç³»çµ±è¨­å®š</span></div></div></nav><div className="sidebar-footer"><div className="user-card"><div className="user-avatar">{user.name?.charAt(0)||'U'}</div><div className="user-info"><div className="user-name">{user.name}</div><div className="user-email">{user.email}</div></div><button className="btn btn-icon btn-ghost" onClick={onLogout}>{I.logout}</button></div></div></aside>)}
        
        function Dashboard({events,regs}){const stats=[{icon:I.events,cls:'purple',val:events.length,label:'æ´»å‹•ç¸½æ•¸',trend:'+2'},{icon:I.people,cls:'green',val:regs.length,label:'å ±åç¸½äººæ•¸',trend:'+12'},{icon:I.notification,cls:'blue',val:events.reduce((s,e)=>s+e.notifications,0),label:'å·²ç™¼é€é€šçŸ¥',trend:'+5'},{icon:I.certificate,cls:'orange',val:events.reduce((s,e)=>s+e.certificates,0),label:'å·²ç™¼è­‰æ›¸',trend:'+45'}];const active=events.filter(e=>e.status==='active');const recent=[...regs].sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt)).slice(0,5);return(<div className="fade"><div className="stats-grid">{stats.map((s,i)=>(<div key={i} className="stat-card"><div className="stat-header"><div className={`stat-icon ${s.cls}`}>{s.icon}</div><span className="stat-trend">{s.trend}</span></div><div className="stat-value">{s.val}</div><div className="stat-label">{s.label}</div></div>))}</div><div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'24px'}}><div className="card"><div className="card-header"><h3 className="card-title">é€²è¡Œä¸­çš„æ´»å‹•</h3></div><div className="card-body">{active.length===0?<div style={{textAlign:'center',padding:'20px',color:'var(--text2)'}}>ç›®å‰æ²’æœ‰é€²è¡Œä¸­çš„æ´»å‹•</div>:active.map(ev=>(<div key={ev.id} style={{padding:'16px',borderBottom:'1px solid var(--border)',display:'flex',justifyContent:'space-between',alignItems:'center'}}><div><div style={{fontWeight:'600',marginBottom:'4px'}}>{ev.title}</div><div style={{fontSize:'13px',color:'var(--text2)'}}>{I.calendar} {ev.date} {ev.time}</div></div><div style={{textAlign:'right'}}><div style={{fontSize:'20px',fontWeight:'700',color:'var(--accent)'}}>{ev.registrations}/{ev.maxParticipants}</div><div style={{fontSize:'12px',color:'var(--text3)'}}>å·²å ±å</div></div></div>))}</div></div><div className="card"><div className="card-header"><h3 className="card-title">æœ€æ–°å ±å</h3></div><div className="card-body">{recent.length===0?<div style={{textAlign:'center',padding:'20px',color:'var(--text2)'}}>é‚„æ²’æœ‰äººå ±å</div>:recent.map(r=>{const ev=events.find(e=>e.id===r.eventId);return(<div key={r.id} style={{padding:'12px 0',borderBottom:'1px solid var(--border)',display:'flex',alignItems:'center',gap:'12px'}}><div style={{width:'40px',height:'40px',background:'linear-gradient(135deg,#3b82f6,#06b6d4)',borderRadius:'10px',display:'flex',alignItems:'center',justifyContent:'center',fontWeight:'600'}}>{r.name.charAt(0)}</div><div style={{flex:1}}><div style={{fontWeight:'500'}}>{r.name}</div><div style={{fontSize:'12px',color:'var(--text3)'}}>{ev?.title||'æœªçŸ¥æ´»å‹•'}</div></div><span className={`badge badge-${r.status==='confirmed'?'success':'warning'}`}>{r.status==='confirmed'?'å·²ç¢ºèª':'å¾…ç¢ºèª'}</span></div>)})}</div></div></div></div>)}
        
        function EventsPage({events,setEvents}){const[modal,setModal]=useState(false);const[editing,setEditing]=useState(null);const{addToast}=useToast();const save=data=>{if(editing){setEvents(events.map(e=>e.id===editing.id?{...e,...data}:e));addToast('æ´»å‹•å·²æ›´æ–°')}else{setEvents([...events,{...data,id:Date.now().toString(),registrations:0,notifications:0,certificates:0}]);addToast('æ´»å‹•å·²å»ºç«‹')}setModal(false);setEditing(null)};const del=id=>{if(confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')){setEvents(events.filter(e=>e.id!==id));addToast('æ´»å‹•å·²åˆªé™¤')}};const copyLink=id=>{navigator.clipboard.writeText(`${location.origin}${location.pathname}?register=${id}`);addToast('å ±åé€£çµå·²è¤‡è£½')};return(<div className="fade"><div style={{marginBottom:'24px',display:'flex',justifyContent:'flex-end'}}><button className="btn btn-primary" onClick={()=>{setEditing(null);setModal(true)}}>{I.add} å»ºç«‹æ–°æ´»å‹•</button></div>{events.length===0?<div className="card"><div className="empty"><div className="empty-icon">{I.events}</div><h3 className="empty-title">é‚„æ²’æœ‰ä»»ä½•æ´»å‹•</h3><p className="empty-text">å»ºç«‹æ‚¨çš„ç¬¬ä¸€å€‹å·¥ä½œåŠæ´»å‹•</p><button className="btn btn-primary" onClick={()=>setModal(true)}>{I.add} å»ºç«‹æ´»å‹•</button></div></div>:<div className="events-grid">{events.map(ev=>(<div key={ev.id} className="event-card"><div className="event-banner" style={{background:ev.status==='active'?'var(--grad)':ev.status==='draft'?'var(--bg3)':'linear-gradient(135deg,#374151,#1f2937)'}}>{I.events}<span className={`event-status ${ev.status}`}>{ev.status==='active'?'é€²è¡Œä¸­':ev.status==='draft'?'è‰ç¨¿':'å·²çµæŸ'}</span></div><div className="event-content"><h3 className="event-title">{ev.title}</h3><div className="event-meta"><span className="event-meta-item">{I.calendar} {ev.date} {ev.time}</span><span className="event-meta-item">{I.location} {ev.location}</span></div><div className="event-stats"><div className="event-stat"><div className="event-stat-value">{ev.registrations}</div><div className="event-stat-label">å ±å</div></div><div className="event-stat"><div className="event-stat-value">{ev.maxParticipants}</div><div className="event-stat-label">åé¡</div></div><div className="event-stat"><div className="event-stat-value">{ev.notifications}</div><div className="event-stat-label">é€šçŸ¥</div></div><div className="event-stat"><div className="event-stat-value">{ev.certificates}</div><div className="event-stat-label">è­‰æ›¸</div></div></div><div style={{display:'flex',gap:'8px',marginTop:'16px'}}><button className="btn btn-secondary" style={{flex:1}} onClick={()=>copyLink(ev.id)}>{I.link} å ±åé€£çµ</button><button className="btn btn-ghost" onClick={()=>{setEditing(ev);setModal(true)}}>{I.edit}</button><button className="btn btn-ghost" onClick={()=>del(ev.id)}>{I.delete}</button></div></div></div>))}</div>}{modal&&<EventModal event={editing} onClose={()=>{setModal(false);setEditing(null)}} onSave={save}/>}</div>)}
        
        function EventModal({event,onClose,onSave}){const[form,setForm]=useState(event||{title:'',description:'',date:'',time:'',endTime:'',location:'',maxParticipants:30,status:'draft',instructorName:''});const submit=e=>{e.preventDefault();onSave(form)};return(<div className="modal-overlay" onClick={onClose}><div className="modal" onClick={e=>e.stopPropagation()}><div className="modal-header"><h2 className="modal-title">{event?'ç·¨è¼¯æ´»å‹•':'å»ºç«‹æ–°æ´»å‹•'}</h2><button className="modal-close" onClick={onClose}>{I.close}</button></div><form onSubmit={submit}><div className="modal-body"><div className="form-group"><label className="form-label">æ´»å‹•åç¨±</label><input type="text" className="form-input" value={form.title} onChange={e=>setForm({...form,title:e.target.value})} required/></div><div className="form-group"><label className="form-label">æ´»å‹•èªªæ˜</label><textarea className="form-input form-textarea" value={form.description} onChange={e=>setForm({...form,description:e.target.value})}/></div><div className="form-row"><div className="form-group"><label className="form-label">æ´»å‹•æ—¥æœŸ</label><input type="date" className="form-input" value={form.date} onChange={e=>setForm({...form,date:e.target.value})} required/></div><div className="form-group"><label className="form-label">é–‹å§‹æ™‚é–“</label><input type="time" className="form-input" value={form.time} onChange={e=>setForm({...form,time:e.target.value})} required/></div></div><div className="form-row"><div className="form-group"><label className="form-label">çµæŸæ™‚é–“</label><input type="time" className="form-input" value={form.endTime} onChange={e=>setForm({...form,endTime:e.target.value})}/></div><div className="form-group"><label className="form-label">è¬›å¸«å§“å</label><input type="text" className="form-input" value={form.instructorName} onChange={e=>setForm({...form,instructorName:e.target.value})}/></div></div><div className="form-row"><div className="form-group"><label className="form-label">åœ°é»</label><input type="text" className="form-input" value={form.location} onChange={e=>setForm({...form,location:e.target.value})} required/></div><div className="form-group"><label className="form-label">å ±åä¸Šé™</label><input type="number" className="form-input" value={form.maxParticipants} onChange={e=>setForm({...form,maxParticipants:parseInt(e.target.value)})} min="1" required/></div></div><div className="form-group"><label className="form-label">æ´»å‹•ç‹€æ…‹</label><select className="form-input form-select" value={form.status} onChange={e=>setForm({...form,status:e.target.value})}><option value="draft">è‰ç¨¿</option><option value="active">é€²è¡Œä¸­</option><option value="ended">å·²çµæŸ</option></select></div></div><div className="modal-footer"><button type="button" className="btn btn-secondary" onClick={onClose}>å–æ¶ˆ</button><button type="submit" className="btn btn-primary">{event?'å„²å­˜':'å»ºç«‹'}</button></div></form></div></div>)}
        
        function RegsPage({events,regs,setRegs}){const[sel,setSel]=useState('all');const[modal,setModal]=useState(false);const{addToast}=useToast();const filtered=sel==='all'?regs:regs.filter(r=>r.eventId===sel);const toggle=(id,st)=>{setRegs(regs.map(r=>r.id===id?{...r,status:st}:r));addToast('ç‹€æ…‹å·²æ›´æ–°')};const del=id=>{if(confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')){setRegs(regs.filter(r=>r.id!==id));addToast('å·²åˆªé™¤')}};const add=data=>{setRegs([...regs,{...data,id:Date.now().toString(),createdAt:new Date().toISOString().split('T')[0],status:'pending'}]);addToast('å·²æ–°å¢');setModal(false)};const csv=()=>{const h=['å§“å','Email','é›»è©±','æ´»å‹•','æ—¥æœŸ','ç‹€æ…‹'];const rows=filtered.map(r=>{const ev=events.find(e=>e.id===r.eventId);return[r.name,r.email,r.phone,ev?.title||'',r.createdAt,r.status==='confirmed'?'å·²ç¢ºèª':'å¾…ç¢ºèª']});const c=[h,...rows].map(row=>row.join(',')).join('\n');const blob=new Blob(['\ufeff'+c],{type:'text/csv;charset=utf-8;'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=`å ±ååå–®_${new Date().toISOString().split('T')[0]}.csv`;a.click();addToast('CSV å·²ä¸‹è¼‰')};return(<div className="fade"><div style={{marginBottom:'24px',display:'flex',justifyContent:'space-between',alignItems:'center'}}><select className="form-input form-select" style={{width:'300px'}} value={sel} onChange={e=>setSel(e.target.value)}><option value="all">æ‰€æœ‰æ´»å‹•</option>{events.map(ev=>(<option key={ev.id} value={ev.id}>{ev.title}</option>))}</select><div style={{display:'flex',gap:'12px'}}><button className="btn btn-secondary" onClick={csv}>{I.download} åŒ¯å‡º CSV</button><button className="btn btn-primary" onClick={()=>setModal(true)}>{I.add} æ–°å¢å ±å</button></div></div><div className="card">{filtered.length===0?<div className="empty"><div className="empty-icon">{I.registrations}</div><h3 className="empty-title">é‚„æ²’æœ‰å ±åè³‡æ–™</h3><p className="empty-text">åˆ†äº«å ±åé€£çµæˆ–æ‰‹å‹•æ–°å¢</p></div>:<div style={{overflowX:'auto'}}><table className="table"><thead><tr><th>å§“å</th><th>Email</th><th>é›»è©±</th><th>æ´»å‹•</th><th>æ—¥æœŸ</th><th>ç‹€æ…‹</th><th>æ“ä½œ</th></tr></thead><tbody>{filtered.map(r=>{const ev=events.find(e=>e.id===r.eventId);return(<tr key={r.id}><td style={{fontWeight:'500'}}>{r.name}</td><td>{r.email}</td><td>{r.phone}</td><td>{ev?.title||'-'}</td><td>{r.createdAt}</td><td><span className={`badge badge-${r.status==='confirmed'?'success':'warning'}`}>{r.status==='confirmed'?'å·²ç¢ºèª':'å¾…ç¢ºèª'}</span></td><td><div style={{display:'flex',gap:'8px'}}><button className="btn btn-ghost btn-icon" onClick={()=>toggle(r.id,r.status==='confirmed'?'pending':'confirmed')}>{I.check}</button><button className="btn btn-ghost btn-icon" onClick={()=>del(r.id)}>{I.delete}</button></div></td></tr>)})}</tbody></table></div>}</div>{modal&&<AddRegModal events={events} onClose={()=>setModal(false)} onSave={add}/>}</div>)}
        
        function AddRegModal({events,onClose,onSave}){const[form,setForm]=useState({eventId:events[0]?.id||'',name:'',email:'',phone:''});const submit=e=>{e.preventDefault();onSave(form)};return(<div className="modal-overlay" onClick={onClose}><div className="modal" onClick={e=>e.stopPropagation()}><div className="modal-header"><h2 className="modal-title">æ–°å¢å ±å</h2><button className="modal-close" onClick={onClose}>{I.close}</button></div><form onSubmit={submit}><div className="modal-body"><div className="form-group"><label className="form-label">é¸æ“‡æ´»å‹•</label><select className="form-input form-select" value={form.eventId} onChange={e=>setForm({...form,eventId:e.target.value})} required>{events.map(ev=>(<option key={ev.id} value={ev.id}>{ev.title}</option>))}</select></div><div className="form-group"><label className="form-label">å§“å</label><input type="text" className="form-input" value={form.name} onChange={e=>setForm({...form,name:e.target.value})} required/></div><div className="form-group"><label className="form-label">Email</label><input type="email" className="form-input" value={form.email} onChange={e=>setForm({...form,email:e.target.value})} required/></div><div className="form-group"><label className="form-label">é›»è©±</label><input type="tel" className="form-input" value={form.phone} onChange={e=>setForm({...form,phone:e.target.value})} required/></div></div><div className="modal-footer"><button type="button" className="btn btn-secondary" onClick={onClose}>å–æ¶ˆ</button><button type="submit" className="btn btn-primary">æ–°å¢</button></div></form></div></div>)}
        
        function PosterPage({events,settings}){const[sel,setSel]=useState(events[0]?.id||'');const[gen,setGen]=useState(false);const[content,setContent]=useState('');const[style,setStyle]=useState('social');const[extra,setExtra]=useState('');const{addToast}=useToast();const ev=events.find(e=>e.id===sel);const styles={social:'ç¤¾ç¾¤è²¼æ–‡é¢¨æ ¼ï¼Œæ´»æ½‘æœ‰è¶£ï¼ŒåŒ…å« emoji å’Œ hashtag',formal:'æ­£å¼é‚€è«‹å‡½é¢¨æ ¼ï¼Œå°ˆæ¥­èŠé‡',casual:'è¼•é¬†å£èªé¢¨æ ¼ï¼Œè¦ªåˆ‡è‡ªç„¶',marketing:'è¡ŒéŠ·æ–‡æ¡ˆé¢¨æ ¼ï¼Œå¼·èª¿åƒ¹å€¼å’Œæ€¥è¿«æ€§'};const generate=async()=>{if(!ev)return;setGen(true);setContent('');const prompt=`ä½ æ˜¯æ´»å‹•æ–‡æ¡ˆå°ˆå®¶ã€‚è«‹ç‚ºä»¥ä¸‹å·¥ä½œåŠæ’°å¯«å®£å‚³æ–‡æ¡ˆã€‚\n\næ´»å‹•ï¼š${ev.title}\nèªªæ˜ï¼š${ev.description||'ç„¡'}\næ™‚é–“ï¼š${ev.date} ${ev.time}${ev.endTime?' - '+ev.endTime:''}\nåœ°é»ï¼š${ev.location}\nåé¡ï¼š${ev.maxParticipants}\nè¬›å¸«ï¼š${ev.instructorName||'å°ˆæ¥­è¬›å¸«'}\n\né¢¨æ ¼ï¼š${styles[style]}\n${extra?'é¡å¤–è¦æ±‚ï¼š'+extra:''}\n\nç›´æ¥è¼¸å‡ºæ–‡æ¡ˆï¼Œç´„200-400å­—ã€‚`;try{if(settings.geminiApiKey){const r=await callGemini(settings.geminiApiKey,prompt);setContent(r);addToast('AI æ–‡å®£å·²ç”Ÿæˆ')}else{await new Promise(r=>setTimeout(r,1000));const t={social:`ğŸ‰ ${ev.title} é–‹æ”¾å ±åå•¦ï¼\n\nğŸ“… ${ev.date} ${ev.time}\nğŸ“ ${ev.location}\nğŸ‘¥ é™é¡ ${ev.maxParticipants} äºº\n\n${ev.description||'ç²¾å½©å…§å®¹ç­‰ä½ ä¾†ï¼'}\n\nâœ¨ åé¡æœ‰é™ï¼Œæ‰‹åˆ€å ±å âœ¨\n\n#å·¥ä½œåŠ #å­¸ç¿’`,formal:`æ•¬é‚€åƒåŠ ã€${ev.title}ã€‘\n\nâ–æ´»å‹•è³‡è¨Š\næ—¥æœŸï¼š${ev.date}\næ™‚é–“ï¼š${ev.time}${ev.endTime?' - '+ev.endTime:''}\nåœ°é»ï¼š${ev.location}\nåé¡ï¼š${ev.maxParticipants} ä½\n\nâ–æ´»å‹•å…§å®¹\n${ev.description||'è©³è¦‹å ±åé é¢'}\n\næœŸå¾…æ‚¨çš„åƒèˆ‡ã€‚`,casual:`å“ˆå›‰ï½\n\n${ev.title} ä¾†å›‰ï¼\n\næ™‚é–“ï¼š${ev.date} ${ev.time}\nåœ°é»ï¼š${ev.location}\n\n${ev.description||'é€™æ¬¡æœƒå­¸åˆ°å¾ˆå¤šæœ‰è¶£çš„æ±è¥¿ï¼'}\n\nåªæœ‰ ${ev.maxParticipants} å€‹ä½å­\nå¿«ä¾†å ±åï½`,marketing:`ğŸ”¥ é™æ™‚å ±åä¸­ ğŸ”¥\n\nã€${ev.title}ã€‘\n\né€™å¯èƒ½æ˜¯ä½ ä»Šå¹´æœ€å€¼å¾—æŠ•è³‡çš„ä¸€å ‚èª²ï¼\n\nğŸ“Œ ${ev.date} ${ev.time}\nğŸ“Œ ${ev.location}\nğŸ“Œ é™é¡ ${ev.maxParticipants} äºº\n\n${ev.description||''}\n\nâš¡ åé¡æœ‰é™ï¼Œé¡æ»¿ç‚ºæ­¢\n\nğŸ‘‰ ç«‹å³å ±åï¼`};setContent(t[style]);addToast('æ–‡å®£å·²ç”Ÿæˆï¼ˆè¨­å®š Gemini API å¯å•Ÿç”¨ AIï¼‰','warning')}}catch(e){addToast(e.message,'error')}setGen(false)};const copy=()=>{navigator.clipboard.writeText(content);addToast('å·²è¤‡è£½')};return(<div className="fade"><div className="panel"><h3 className="panel-title">{I.ai} AI æ–‡å®£ç”¢ç”Ÿå™¨ {settings.geminiApiKey&&<span className="badge badge-success">Gemini å·²é€£æ¥</span>}</h3><div className="form-row" style={{marginBottom:'20px'}}><div className="form-group" style={{marginBottom:0}}><label className="form-label">é¸æ“‡æ´»å‹•</label><select className="form-input form-select" value={sel} onChange={e=>setSel(e.target.value)}>{events.map(ev=>(<option key={ev.id} value={ev.id}>{ev.title}</option>))}</select></div><div className="form-group" style={{marginBottom:0}}><label className="form-label">æ–‡æ¡ˆé¢¨æ ¼</label><select className="form-input form-select" value={style} onChange={e=>setStyle(e.target.value)}><option value="social">ç¤¾ç¾¤è²¼æ–‡</option><option value="casual">è¼•é¬†æ´»æ½‘</option><option value="formal">æ­£å¼é‚€è«‹å‡½</option><option value="marketing">è¡ŒéŠ·æ–‡æ¡ˆ</option></select></div></div>{settings.geminiApiKey&&<div className="form-group"><label className="form-label">é¡å¤–æŒ‡ç¤º</label><input type="text" className="form-input" value={extra} onChange={e=>setExtra(e.target.value)} placeholder="ä¾‹ï¼šå¼·èª¿å¯¦ä½œç·´ç¿’..."/></div>}<button className="btn btn-ai" onClick={generate} disabled={gen||!sel} style={{marginBottom:'20px'}}>{gen?I.loading+' AI ç”Ÿæˆä¸­...':I.magic+' ç”Ÿæˆæ–‡å®£'}</button>{content&&<div style={{position:'relative'}}><button className="btn btn-secondary btn-icon copy-btn" onClick={copy}>{I.copy}</button><div className="output">{content}</div></div>}</div>{!settings.geminiApiKey&&<div className="card"><div className="card-body" style={{textAlign:'center',padding:'40px'}}><div style={{fontSize:'40px',marginBottom:'16px'}}>{I.ai}</div><h3 style={{marginBottom:'8px'}}>å•Ÿç”¨ AI æ™ºæ…§ç”Ÿæˆ</h3><p style={{color:'var(--text2)'}}>è¨­å®š Gemini API Key å¾Œï¼ŒAI å°‡æ ¹æ“šæ´»å‹•å…§å®¹ç”Ÿæˆç¨ç‰¹æ–‡æ¡ˆ</p><p style={{fontSize:'13px',color:'var(--text3)',marginTop:'12px'}}>å‰å¾€ã€Œç³»çµ±è¨­å®šã€é é¢è¨­å®š</p></div></div>}</div>)}
        
        function NotifyPage({events,regs,setEvents,settings}){const[sel,setSel]=useState(events[0]?.id||'');const[type,setType]=useState('reminder');const[custom,setCustom]=useState('');const[sending,setSending]=useState(false);const[method,setMethod]=useState('email');const{addToast}=useToast();const ev=events.find(e=>e.id===sel);const evRegs=regs.filter(r=>r.eventId===sel);const tpl={reminder:`è¦ªæ„›çš„å­¸å“¡æ‚¨å¥½ï¼Œ\n\næé†’æ‚¨ï¼Œã€Œ${ev?.title||'å·¥ä½œåŠ'}ã€å°‡æ–¼ ${ev?.date||''} ${ev?.time||''} èˆ‰è¡Œã€‚\n\nğŸ“ åœ°é»ï¼š${ev?.location||''}\n\nè«‹æº–æ™‚å‡ºå¸­ï¼\n\n${ev?.instructorName||'è¬›å¸«'} æ•¬ä¸Š`,confirm:`è¦ªæ„›çš„å­¸å“¡æ‚¨å¥½ï¼Œ\n\næ­å–œæ‚¨æˆåŠŸå ±åã€Œ${ev?.title||'å·¥ä½œåŠ'}ã€ï¼\n\nğŸ“… ${ev?.date||''} ${ev?.time||''}\nğŸ“ ${ev?.location||''}\n\næ´»å‹•ç•¶å¤©è«‹æå‰ 10 åˆ†é˜å ±åˆ°ã€‚\n\n${ev?.instructorName||'è¬›å¸«'} æ•¬ä¸Š`,cancel:`è¦ªæ„›çš„å­¸å“¡æ‚¨å¥½ï¼Œ\n\nå¾ˆæŠ±æ­‰ï¼Œã€Œ${ev?.title||'å·¥ä½œåŠ'}ã€å› æ•…å–æ¶ˆã€‚\n\nå¾ŒçºŒå°‡å¦è¡Œé€šçŸ¥ã€‚é€ æˆä¸ä¾¿ï¼Œæ•¬è«‹è¦‹è«’ã€‚`,custom:custom};const send=async()=>{if(!ev||evRegs.length===0){addToast('è«‹é¸æ“‡æœ‰å ±åè€…çš„æ´»å‹•','warning');return}setSending(true);await new Promise(r=>setTimeout(r,1500));setEvents(events.map(e=>e.id===sel?{...e,notifications:e.notifications+1}:e));addToast(`å·²ç™¼é€${method==='line'?' LINE ':' Email '}é€šçŸ¥çµ¦ ${evRegs.length} ä½å­¸å“¡`);setSending(false)};return(<div className="fade"><div className="panel"><h3 className="panel-title">{I.notification} é€šçŸ¥ä¸­å¿ƒ {settings.lineChannelToken&&<span className="badge badge-success" style={{marginLeft:'8px'}}>LINE å·²é€£æ¥</span>}</h3><div className="form-row" style={{marginBottom:'20px'}}><div className="form-group" style={{marginBottom:0}}><label className="form-label">é¸æ“‡æ´»å‹•</label><select className="form-input form-select" value={sel} onChange={e=>setSel(e.target.value)}>{events.map(ev=>(<option key={ev.id} value={ev.id}>{ev.title} ({regs.filter(r=>r.eventId===ev.id).length} äºº)</option>))}</select></div><div className="form-group" style={{marginBottom:0}}><label className="form-label">é€šçŸ¥é¡å‹</label><select className="form-input form-select" value={type} onChange={e=>setType(e.target.value)}><option value="reminder">æ´»å‹•æé†’</option><option value="confirm">å ±åç¢ºèª</option><option value="cancel">æ´»å‹•å–æ¶ˆ</option><option value="custom">è‡ªè¨‚å…§å®¹</option></select></div></div><div className="form-group"><label className="form-label">ç™¼é€æ–¹å¼</label><div style={{display:'flex',gap:'16px'}}><label className="checkbox-wrapper"><div className={`checkbox ${method==='email'?'checked':''}`} onClick={()=>setMethod('email')}>{method==='email'&&I.check}</div><span>{I.email} Email</span></label><label className="checkbox-wrapper"><div className={`checkbox ${method==='line'?'checked':''}`} onClick={()=>setMethod('line')}>{method==='line'&&I.check}</div><span>{I.line} LINE {!settings.lineChannelToken&&'(æœªè¨­å®š)'}</span></label></div></div>{type==='custom'&&<div className="form-group"><label className="form-label">è‡ªè¨‚è¨Šæ¯</label><textarea className="form-input form-textarea" value={custom} onChange={e=>setCustom(e.target.value)} placeholder="è¼¸å…¥è¨Šæ¯..." style={{minHeight:'150px'}}/></div>}<div style={{marginBottom:'20px'}}><label className="form-label">è¨Šæ¯é è¦½</label><div className="output" style={{minHeight:'150px'}}>{tpl[type]}</div></div><div style={{display:'flex',gap:'12px',alignItems:'center'}}><button className="btn btn-primary" onClick={send} disabled={sending||evRegs.length===0}>{sending?I.loading+' ç™¼é€ä¸­...':I.send+` ç™¼é€çµ¦ ${evRegs.length} ä½å­¸å“¡`}</button>{method==='line'&&!settings.lineChannelToken&&<span style={{color:'var(--warning)',fontSize:'13px'}}>{I.warning} è«‹å…ˆè¨­å®š LINE Token</span>}</div></div><div className="card"><div className="card-header"><h3 className="card-title">ç™¼é€ç´€éŒ„</h3></div><div className="card-body">{events.filter(e=>e.notifications>0).length===0?<div style={{textAlign:'center',padding:'20px',color:'var(--text2)'}}>é‚„æ²’æœ‰ç™¼é€éé€šçŸ¥</div>:events.filter(e=>e.notifications>0).map(ev=>(<div key={ev.id} style={{padding:'12px 0',borderBottom:'1px solid var(--border)',display:'flex',justifyContent:'space-between'}}><span>{ev.title}</span><span className="badge badge-info">{ev.notifications} æ¬¡ç™¼é€</span></div>))}</div></div></div>)}
        
        function CertPage({events,regs,setEvents}){const[sel,setSel]=useState(events[0]?.id||'');const[checked,setChecked]=useState([]);const[gen,setGen]=useState(false);const[preview,setPreview]=useState('å­¸å“¡å§“å');const{addToast}=useToast();const ev=events.find(e=>e.id===sel);const evRegs=regs.filter(r=>r.eventId===sel&&r.status==='confirmed');const toggle=id=>{const r=regs.find(x=>x.id===id);if(r)setPreview(r.name);setChecked(p=>p.includes(id)?p.filter(x=>x!==id):[...p,id])};const all=()=>{if(checked.length===evRegs.length)setChecked([]);else setChecked(evRegs.map(r=>r.id))};const makePDF=async name=>{const{jsPDF}=window.jspdf;const doc=new jsPDF({orientation:'landscape',unit:'mm',format:'a4'});doc.setFillColor(254,252,232);doc.rect(0,0,297,210,'F');doc.setDrawColor(180,83,9);doc.setLineWidth(2);doc.rect(10,10,277,190);doc.setLineWidth(0.5);doc.rect(15,15,267,180);doc.setFont('helvetica','normal');doc.setFontSize(12);doc.setTextColor(146,64,14);doc.text('CERTIFICATE OF COMPLETION',148.5,35,{align:'center'});doc.setFontSize(36);doc.setTextColor(120,53,15);doc.text('Certificate',148.5,55,{align:'center'});doc.setDrawColor(180,83,9);doc.line(80,62,217,62);doc.setFontSize(28);doc.setTextColor(180,83,9);doc.text(name,148.5,90,{align:'center'});const w=doc.getTextWidth(name);doc.line(148.5-w/2-10,95,148.5+w/2+10,95);doc.setFontSize(14);doc.setTextColor(68,64,60);doc.text('has successfully completed the course',148.5,115,{align:'center'});doc.setFontSize(18);doc.setTextColor(120,53,15);doc.text(`"${ev?.title||'Workshop'}"`,148.5,130,{align:'center'});doc.setFontSize(12);doc.setTextColor(68,64,60);doc.text(`Date: ${ev?.date||''}`,148.5,150,{align:'center'});doc.setDrawColor(120,53,15);doc.line(50,175,120,175);doc.line(177,175,247,175);doc.setFontSize(10);doc.setTextColor(120,53,15);doc.text('Instructor',85,182,{align:'center'});doc.text('Date',212,182,{align:'center'});doc.setFontSize(12);doc.text(ev?.instructorName||'Instructor',85,172,{align:'center'});doc.text(ev?.date||'',212,172,{align:'center'});return doc};const generate=async()=>{if(checked.length===0){addToast('è«‹é¸æ“‡å­¸å“¡','warning');return}setGen(true);try{for(const id of checked){const r=regs.find(x=>x.id===id);if(r){const pdf=await makePDF(r.name);pdf.save(`è­‰æ›¸_${ev?.title||'Workshop'}_${r.name}.pdf`);await new Promise(res=>setTimeout(res,300))}}setEvents(events.map(e=>e.id===sel?{...e,certificates:e.certificates+checked.length}:e));addToast(`å·²ä¸‹è¼‰ ${checked.length} å¼µè­‰æ›¸`);setChecked([])}catch(e){addToast('ç”Ÿæˆå¤±æ•—','error')}setGen(false)};const previewPDF=async()=>{const pdf=await makePDF(preview);window.open(URL.createObjectURL(pdf.output('blob')),'_blank')};return(<div className="fade"><div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'24px'}}><div><div className="panel"><h3 className="panel-title">{I.certificate} PDF è­‰æ›¸ç”¢ç”Ÿå™¨</h3><div className="form-group"><label className="form-label">é¸æ“‡æ´»å‹•</label><select className="form-input form-select" value={sel} onChange={e=>{setSel(e.target.value);setChecked([])}}>{events.map(ev=>(<option key={ev.id} value={ev.id}>{ev.title}</option>))}</select></div><div style={{marginBottom:'16px'}}><div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'12px'}}><label className="form-label" style={{marginBottom:0}}>é¸æ“‡å­¸å“¡ï¼ˆå·²ç¢ºèªå ±åï¼‰</label><button className="btn btn-ghost" style={{padding:'4px 12px',fontSize:'13px'}} onClick={all}>{checked.length===evRegs.length?'å–æ¶ˆå…¨é¸':'å…¨é¸'}</button></div><div style={{background:'var(--bg2)',border:'1px solid var(--border)',borderRadius:'12px',maxHeight:'200px',overflowY:'auto'}}>{evRegs.length===0?<div style={{padding:'20px',textAlign:'center',color:'var(--text3)'}}>æ²’æœ‰å·²ç¢ºèªçš„å ±åè€…</div>:evRegs.map(r=>(<div key={r.id} className="checkbox-wrapper" onClick={()=>toggle(r.id)} style={{padding:'12px 16px',borderBottom:'1px solid var(--border)'}}><div className={`checkbox ${checked.includes(r.id)?'checked':''}`}>{checked.includes(r.id)&&I.check}</div><span style={{fontSize:'14px'}}>{r.name}</span><span style={{marginLeft:'auto',fontSize:'12px',color:'var(--text3)'}}>{r.email}</span></div>))}</div></div><div style={{display:'flex',gap:'12px'}}><button className="btn btn-primary" onClick={generate} disabled={gen||checked.length===0} style={{flex:1}}>{gen?I.loading+' ç”Ÿæˆä¸­...':`${I.download} ä¸‹è¼‰ ${checked.length} å¼µè­‰æ›¸`}</button><button className="btn btn-secondary" onClick={previewPDF}>é è¦½</button></div></div></div><div><div className="card"><div className="card-header"><h3 className="card-title">è­‰æ›¸é è¦½</h3></div><div className="card-body"><div className="cert-preview"><div className="cert"><div className="cert-header">CERTIFICATE OF COMPLETION</div><div className="cert-title">Certificate</div><div className="cert-name">{preview}</div><div className="cert-body">has successfully completed the course<br/>ã€Œ{ev?.title||'å·¥ä½œåŠèª²ç¨‹'}ã€</div><div className="cert-footer"><div className="cert-sig"><div style={{marginBottom:'8px'}}>{ev?.instructorName||'è¬›å¸«'}</div><div className="cert-sig-line"></div><div className="cert-sig-label">Instructor</div></div><div className="cert-sig"><div style={{marginBottom:'8px'}}>{ev?.date||''}</div><div className="cert-sig-line"></div><div className="cert-sig-label">Date</div></div></div></div></div></div></div></div></div></div>)}
        
        function SettingsPage({settings,setSettings}){const{addToast}=useToast();const[showKey,setShowKey]=useState(false);const save=()=>{localStorage.setItem('workshopSettings',JSON.stringify(settings));addToast('è¨­å®šå·²å„²å­˜')};return(<div className="fade"><div className="card" style={{marginBottom:'24px'}}><div className="card-header"><h3 className="card-title">{I.ai} Gemini AI è¨­å®š</h3></div><div className="card-body"><div className="form-group"><label className="form-label">Gemini API Key</label><div style={{position:'relative'}}><input type={showKey?'text':'password'} className="form-input" value={settings.geminiApiKey} onChange={e=>setSettings({...settings,geminiApiKey:e.target.value})} placeholder="AIza..." style={{paddingRight:'50px'}}/><button onClick={()=>setShowKey(!showKey)} style={{position:'absolute',right:'12px',top:'50%',transform:'translateY(-50%)',background:'none',border:'none',color:'var(--text3)',cursor:'pointer',fontSize:'16px'}}>{showKey?'ğŸ™ˆ':'ğŸ‘ï¸'}</button></div><p style={{fontSize:'12px',color:'var(--text3)',marginTop:'8px'}}>ç”¨æ–¼ AI æ–‡å®£ç”¢ç”Ÿã€‚å‰å¾€ <a href="https://makersuite.google.com/app/apikey" target="_blank" style={{color:'var(--accent)'}}>Google AI Studio</a> å–å¾—</p></div></div></div><div className="card" style={{marginBottom:'24px'}}><div className="card-header"><h3 className="card-title">{I.line} LINE é€šçŸ¥è¨­å®š</h3></div><div className="card-body"><div className="form-group"><label className="form-label">Channel Access Token</label><input type="password" className="form-input" value={settings.lineChannelToken} onChange={e=>setSettings({...settings,lineChannelToken:e.target.value})} placeholder="è¼¸å…¥ LINE Token"/><p style={{fontSize:'12px',color:'var(--text3)',marginTop:'8px'}}>å‰å¾€ <a href="https://developers.line.biz/console/" target="_blank" style={{color:'var(--accent)'}}>LINE Developers</a> å–å¾—</p></div></div></div><div className="card"><div className="card-header"><h3 className="card-title">{I.info} ç³»çµ±ç‹€æ…‹</h3></div><div className="card-body"><div style={{display:'grid',gap:'12px'}}><div style={{display:'flex',justifyContent:'space-between',padding:'12px',background:'var(--bg3)',borderRadius:'8px'}}><span>Gemini AI</span><span className={`badge badge-${settings.geminiApiKey?'success':'warning'}`}>{settings.geminiApiKey?'å·²é€£æ¥':'æœªè¨­å®š'}</span></div><div style={{display:'flex',justifyContent:'space-between',padding:'12px',background:'var(--bg3)',borderRadius:'8px'}}><span>LINE Messaging</span><span className={`badge badge-${settings.lineChannelToken?'success':'warning'}`}>{settings.lineChannelToken?'å·²é€£æ¥':'æœªè¨­å®š'}</span></div><div style={{display:'flex',justifyContent:'space-between',padding:'12px',background:'var(--bg3)',borderRadius:'8px'}}><span>è³‡æ–™å„²å­˜</span><span className="badge badge-warning">æœ¬æ©Ÿå„²å­˜</span></div></div></div></div><div style={{marginTop:'24px'}}><button className="btn btn-primary" onClick={save}>{I.check} å„²å­˜è¨­å®š</button></div></div>)}
        
        function App(){const[user,setUser]=useState(null);const[page,setPage]=useState('dashboard');const[events,setEvents]=useState([]);const[regs,setRegs]=useState([]);const[settings,setSettings]=useState({geminiApiKey:'',lineChannelToken:''});const[loading,setLoading]=useState(true);const[regId,setRegId]=useState(null);useEffect(()=>{const p=new URLSearchParams(location.search);const r=p.get('register');if(r)setRegId(r);const u=localStorage.getItem('workshopUser');if(u)setUser(JSON.parse(u));const e=localStorage.getItem('workshopEvents');const reg=localStorage.getItem('workshopRegs');const s=localStorage.getItem('workshopSettings');setEvents(e?JSON.parse(e):demoEvents);setRegs(reg?JSON.parse(reg):demoRegs);if(s)setSettings(JSON.parse(s));setLoading(false)},[]);useEffect(()=>{if(events.length>0)localStorage.setItem('workshopEvents',JSON.stringify(events))},[events]);useEffect(()=>{if(regs.length>0)localStorage.setItem('workshopRegs',JSON.stringify(regs))},[regs]);const login=u=>{setUser(u);localStorage.setItem('workshopUser',JSON.stringify(u))};const logout=()=>{setUser(null);localStorage.removeItem('workshopUser')};const pubReg=data=>{const n={...data,id:Date.now().toString()};setRegs(p=>[...p,n]);setEvents(p=>p.map(e=>e.id===data.eventId?{...e,registrations:e.registrations+1}:e))};const titles={dashboard:{t:'ç¸½è¦½å„€è¡¨æ¿',s:'æŸ¥çœ‹ç‡Ÿé‹æ¦‚æ³'},events:{t:'æ´»å‹•ç®¡ç†',s:'å»ºç«‹å’Œç®¡ç†å·¥ä½œåŠ'},registrations:{t:'å ±åç®¡ç†',s:'ç®¡ç†å­¸å“¡å ±å'},poster:{t:'AI æ–‡å®£ç”¢ç”Ÿå™¨',s:'ç”¨ Gemini AI ç”Ÿæˆæ–‡å®£'},notification:{t:'é€šçŸ¥ä¸­å¿ƒ',s:'ç™¼é€ Email/LINE é€šçŸ¥'},certificate:{t:'PDF è­‰æ›¸ç”¢ç”Ÿå™¨',s:'ç‚ºå­¸å“¡ç”Ÿæˆçµæ¥­è­‰æ›¸'},settings:{t:'ç³»çµ±è¨­å®š',s:'è¨­å®š API é‡‘é‘°'}};if(loading)return(<div className="loading-overlay"><div className="loading"></div><div style={{fontSize:'16px',color:'var(--text2)'}}>è¼‰å…¥ä¸­...</div></div>);if(regId)return(<ToastProvider><PublicForm eventId={regId} events={events} onReg={pubReg}/></ToastProvider>);if(!user)return(<ToastProvider><LoginPage onLogin={login}/></ToastProvider>);return(<ToastProvider><div className="layout"><Sidebar user={user} page={page} setPage={setPage} onLogout={logout}/><main className="main"><header className="main-header"><div><h1 className="main-title">{titles[page]?.t}</h1><p className="main-subtitle">{titles[page]?.s}</p></div><div style={{display:'flex',alignItems:'center',gap:'12px'}}><span className="badge badge-warning">å±•ç¤ºæ¨¡å¼</span></div></header><div className="main-body">{page==='dashboard'&&<Dashboard events={events} regs={regs}/>}{page==='events'&&<EventsPage events={events} setEvents={setEvents}/>}{page==='registrations'&&<RegsPage events={events} regs={regs} setRegs={setRegs}/>}{page==='poster'&&<PosterPage events={events} settings={settings}/>}{page==='notification'&&<NotifyPage events={events} regs={regs} setEvents={setEvents} settings={settings}/>}{page==='certificate'&&<CertPage events={events} regs={regs} setEvents={setEvents}/>}{page==='settings'&&<SettingsPage settings={settings} setSettings={setSettings}/>}</div></main></div></ToastProvider>)}
        
        ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
    </script>
</body>
</html>
